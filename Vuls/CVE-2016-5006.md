## Summary:  
Software: cloud_foundry/cloud_controller  
## Fix:  
Commit: https://github.com/cloudfoundry/cloud_controller_ng/commit/416047ed5cf0eafc528de1e1311a31b5513cc16e  
Change Size: +15 -3  
Fix Time (of the Last Commit): 2016-07-06  
Author: Utako Ueda  
Fix Pattern: Sanitization -> Redaction -> Introduction -> Tag/TypeBasedFiltration -> RedactionFunctionDefined  
  
Fixing-commits Count: 1  
Total Change Size: +15 -3  
## Sample logs: Yes  
```  
cloud_controller_ng.log:{"timestamp":1467852651.5074253,"message":"cc.create","log_level":"debug","source":"cc.api","data":{"request_guid":"3f7fe146-2b79-4a2f-79bf-c4a03b5a2159::e587eac0-6000-42da-bc05-610355e49967","model":"UserProvidedServiceInstance","attributes":{"name":"my-db-mine","credentials":"password","space_guid":"cfdcbe8e-788a-440b-b191-9f1054660ac0","syslog_drain_url":"","route_service_url":""}},"thread_id":46939298860000,"fiber_id":46939296433600,"process_id":17560,"file":"/var/vcap/data/packages/cloud_controller_ng/fb56077c25040be5f24ab4e6c900bc164b2848b4.1-d2d11c73895633636bb894fd164ac7581c3a347b/cloud_controller_ng/app/controllers/services/user_provided_service_instances_controller.rb","lineno":56,"method":"create"}  
```  
## Logging statements:  
### Source labels:  
Type of Sensitive Information:authentication data -> sensitive user credential information, user-provided service objects  
### Sink labels:  
#### Sink 1:  
Logging call Function:  Third-party Libaries（CloudFoundry Steno Logging）  
Sensitiveness-Identifiable Source:  跨方法-同文件（https://github.com/cloudfoundry/cloud_controller_ng/blob/416047ed5cf0eafc528de1e1311a31b5513cc16e/app/controllers/services/user_provided_service_instances_controller.rb#L8） -> Variable Names（credentials，finally outputed to logs）  
#### Sink 2:  
Logging call Function:  Third-party Libaries（CloudFoundry Steno Logging）  
Sensitiveness-Identifiable Source:  跨方法-同文件（https://github.com/cloudfoundry/cloud_controller_ng/blob/416047ed5cf0eafc528de1e1311a31b5513cc16e/app/controllers/services/user_provided_service_instances_controller.rb#L8） -> Variable Names（credentials，finally outputed to logs）  
Programming Language:Ruby  
```Ruby  
# https://github.com/cloudfoundry/cloud_controller_ng/blob/416047ed5cf0eafc528de1e1311a31b5513cc16e/app/controllers/services/user_provided_service_instances_controller.rb#L52-L86  
    def create  
      @request_attrs = decode_create_request_attrs  
  
      censored_attrs = censor(@request_attrs)  
      logger.debug 'cc.create', model: self.class.model_class_name, attributes: censored_attrs # HERE IS THE SINK 1  
      service_instance = create_instance(request_attrs)  
      @services_event_repository.record_user_provided_service_instance_event(:create, service_instance, request_attrs)  
      route_service_warning(service_instance) unless route_services_enabled?  
  
      [  
        HTTP::CREATED,  
        { 'Location' => "#{self.class.path}/#{service_instance.guid}" },  
        object_renderer.render_json(self.class, service_instance, @opts)  
      ]  
    end  
  
    def update(guid)  
      @request_attrs = decode_update_request_attrs  
  
      censored_attrs = censor(@request_attrs)  
      logger.debug 'cc.update', guid: guid, attributes: censored_attrs # HERE IS THE SINK 2  
      raise CloudController::Errors::ApiError.new_from_details('InvalidRequest') unless request_attrs  
  
      service_instance = find_guid(guid)  
      validate_access(:read_for_update, service_instance)  
      validate_access(:update, service_instance)  
  
      validate_space_not_changed(request_attrs, service_instance)  
      update_instance(request_attrs, service_instance)  
      propagate_instance_credentials(service_instance)  
  
      @services_event_repository.record_user_provided_service_instance_event(:update, service_instance, request_attrs)  
  
      [HTTP::CREATED, {}, object_renderer.render_json(self.class, service_instance, @opts)]  
    end  
  
# https://github.com/cloudfoundry/cloud_controller_ng/blob/416047ed5cf0eafc528de1e1311a31b5513cc16e/app/controllers/services/user_provided_service_instances_controller.rb#L247-L253  
  
    def censor(request_attrs)  
      request_attrs.dup.tap do |changes|  
        CENSORED_FIELDS.map(&:to_s).each do |censored|  
          changes[censored] = CENSORED_MESSAGE if changes.key?(censored)  
        end  
      end  
    end  
  
```  
