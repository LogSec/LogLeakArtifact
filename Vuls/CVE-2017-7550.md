## Summary:  
Software: ansible  
## Fix:  
Commit: https://github.com/abadger/ansible/commit/3934540d02cf8e16470966f4f3b0b1fdd5ce3ad3  
Author: Toshio Kuratomi  
Fix Time (of the Last Commit): 2017-11-09  
Fix Pattern: Remove -> Entire Function  
  
  
Fixing-commits Count: 3  
Total Change Size: +27 -35  
  
==========  
PR: https://github.com/ansible/ansible/pull/30875  
Commit: https://github.com/abadger/ansible/commit/c80415389a13c2c3373966c736691dff493aab34  
Change Size: +11 -6  
Time: 2017-09-26  
  
  
PR: https://github.com/ansible/ansible/pull/32708  
Commit: https://github.com/abadger/ansible/commit/3934540d02cf8e16470966f4f3b0b1fdd5ce3ad3  
Change Size: +14 -29  
Time: 2017-11-09  
Commit: https://github.com/abadger/ansible/commit/800cc83e553b9a1ca5b4293ed1e0506e6108d031  
Change Size: +2 -0  
Time: 2017-11-09  
## Sample logs: No  
## Logging statements:  
### Source labels:  
Type of Sensitive Information:authentication data -> sensitive information, certain parameters to the jenkins_plugin module  
### Sink labels:  
#### Sink 1:  
Logging call Function:  User-defined（Display.display）  
Sensitiveness-Identifiable Source:  Same Projects & Cross Modules（https://github.com/abadger/ansible/blob/f203ca7907bd3fc0e1882ab65960e6720907fe0f/lib/ansible/modules/web_infrastructure/jenkins_plugin.py#L176） -> Comments  
#### Sink 2:  
Logging call Function:  User-defined（AnsibleModule._return_formatted）  
Sensitiveness-Identifiable Source:  Same Projects & Cross Modules（https://github.com/abadger/ansible/blob/f203ca7907bd3fc0e1882ab65960e6720907fe0f/lib/ansible/modules/web_infrastructure/jenkins_plugin.py#L176） -> Comments  
Programming Language:Python  
```Python  
  
# https://github.com/ansible/ansible/blob/b6811dfb61bee06dad08e90ef541667be7bbc950/lib/ansible/plugins/callback/default.py#L108-L147  
  
    def v2_runner_on_ok(self, result):  
  
        delegated_vars = result._result.get('_ansible_delegated_vars', None)  
  
        if isinstance(result._task, TaskInclude):  
            if self._last_task_banner != result._task._uuid:  
                self._print_task_banner(result._task)  
            return  
        elif result._result.get('changed', False):  
            if self._last_task_banner != result._task._uuid:  
                self._print_task_banner(result._task)  
  
            if delegated_vars:  
                msg = "changed: [%s -> %s]" % (result._host.get_name(), delegated_vars['ansible_host'])  
            else:  
                msg = "changed: [%s]" % result._host.get_name()  
            color = C.COLOR_CHANGED  
        else:  
            if not self.display_ok_hosts:  
                return  
  
            if self._last_task_banner != result._task._uuid:  
                self._print_task_banner(result._task)  
  
            if delegated_vars:  
                msg = "ok: [%s -> %s]" % (result._host.get_name(), delegated_vars['ansible_host'])  
            else:  
                msg = "ok: [%s]" % result._host.get_name()  
            color = C.COLOR_OK  
  
        self._handle_warnings(result._result)  
  
        if result._task.loop and 'results' in result._result:  
            self._process_items(result)  
        else:  
            self._clean_results(result._result, result._task.action)  
  
            if self._run_is_verbose(result):  
                msg += " => %s" % (self._dump_results(result._result),)  
            self._display.display(msg, color=color) # HERE IS THE SINK 1  
  
# https://github.com/abadger/ansible/blob/25e17b40353995f211b9e2c704adf36d326792e2/lib/ansible/modules/web_infrastructure/jenkins_plugin.py#L730-L813  
  
def main():  
    # Module arguments  
    argument_spec = url_argument_spec()  
    argument_spec.update(  
        group=dict(default='jenkins'),  
        jenkins_home=dict(default='/var/lib/jenkins'),  
        mode=dict(default='0644', type='raw'),  
        name=dict(required=True),  
        owner=dict(default='jenkins'),  
        params=dict(type='dict'),  
        state=dict(  
            choices=[  
                'present',  
                'absent',  
                'pinned',  
                'unpinned',  
                'enabled',  
                'disabled',  
                'latest'],  
            default='present'),  
        timeout=dict(default=30, type="int"),  
        updates_expiration=dict(default=86400, type="int"),  
        updates_url=dict(default='https://updates.jenkins-ci.org'),  
        url=dict(default='http://localhost:8080'),  
        url_password=dict(no_log=True),  
        version=dict(),  
        with_dependencies=dict(default=True, type='bool'),  
    )  
    # Module settings  
    module = AnsibleModule(  
        argument_spec=argument_spec,  
        add_file_common_args=True,  
        supports_check_mode=True,  
    )  
  
    # Update module parameters by user's parameters if defined  
    if 'params' in module.params and isinstance(module.params['params'], dict):  
        module.params.update(module.params['params'])  
        # Remove the params  
        module.params.pop('params', None)  
  
    # Force basic authentication  
    module.params['force_basic_auth'] = True  
  
    # Convert timeout to float  
    try:  
        module.params['timeout'] = float(module.params['timeout'])  
    except ValueError:  
        e = get_exception()  
        module.fail_json(  
            msg='Cannot convert %s to float.' % module.params['timeout'],  
            details=to_native(e))  
  
    # Set version to latest if state is latest  
    if module.params['state'] == 'latest':  
        module.params['state'] = 'present'  
        module.params['version'] = 'latest'  
  
    # Create some shortcuts  
    name = module.params['name']  
    state = module.params['state']  
  
    # Initial change state of the task  
    changed = False  
  
    # Instantiate the JenkinsPlugin object  
    jp = JenkinsPlugin(module)  
  
    # Perform action depending on the requested state  
    if state == 'present':  
        changed = jp.install()  
    elif state == 'absent':  
        changed = jp.uninstall()  
    elif state == 'pinned':  
        changed = jp.pin()  
    elif state == 'unpinned':  
        changed = jp.unpin()  
    elif state == 'enabled':  
        changed = jp.enable()  
    elif state == 'disabled':  
        changed = jp.disable()  
  
    # Print status of the change  
    module.exit_json(changed=changed, plugin=name, state=state) # HERE IS THE FLOW  
  
  
# https://github.com/ansible/ansible/blob/b6811dfb61bee06dad08e90ef541667be7bbc950/lib/ansible/module_utils/basic.py#L1898  
      
    def exit_json(self, **kwargs):  
        ''' return from the module, without error '''  
  
        self.do_cleanup_files()  
        self._return_formatted(kwargs) # HERE IS THE SINK 2  
        sys.exit(0)  
  
  
# https://github.com/ansible/ansible/blob/b6811dfb61bee06dad08e90ef541667be7bbc950/lib/ansible/module_utils/basic.py#L1856-L1892  
  
    def _return_formatted(self, kwargs):  
  
        self.add_path_info(kwargs)  
  
        if 'invocation' not in kwargs:  
            kwargs['invocation'] = {'module_args': self.params}  
  
        if 'warnings' in kwargs:  
            if isinstance(kwargs['warnings'], list):  
                for w in kwargs['warnings']:  
                    self.warn(w)  
            else:  
                self.warn(kwargs['warnings'])  
  
        warnings = get_warning_messages()  
        if warnings:  
            kwargs['warnings'] = warnings  
  
        if 'deprecations' in kwargs:  
            if isinstance(kwargs['deprecations'], list):  
                for d in kwargs['deprecations']:  
                    if isinstance(d, SEQUENCETYPE) and len(d) == 2:  
                        self.deprecate(d[0], version=d[1])  
                    elif isinstance(d, Mapping):  
                        self.deprecate(d['msg'], version=d.get('version'), date=d.get('date'),  
                                       collection_name=d.get('collection_name'))  
                    else:  
                        self.deprecate(d)  # pylint: disable=ansible-deprecated-no-version  
            else:  
                self.deprecate(kwargs['deprecations'])  # pylint: disable=ansible-deprecated-no-version  
  
        deprecations = get_deprecation_messages()  
        if deprecations:  
            kwargs['deprecations'] = deprecations  
  
        kwargs = remove_values(kwargs, self.no_log_values)  
        print('\n%s' % self.jsonify(kwargs)) # HERE IS THE INNER SINK  
  
```  
