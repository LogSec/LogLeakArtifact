## Summary:  
Software: ovirt  
## Fix:  
Commit: https://github.com/oVirt/ovirt-engine/commit/e8c72daec4efa8be0fcd8ea55c41e855ddd8eedf  
Change Size: +17 -1  
Fix Time (of the Last Commit): 2012-12-18  
Author: Ravi Nori  
Fix Pattern: Other  
  
Fixing-commits Count: 1  
Total Change Size: +17 -1  
## Sample logs: No  
## Logging statements:  
### Source labels:  
Type of Sensitive Information:authentication data -> administrative password  
### Sink labels:  
#### Sink 1:  
Logging call Function:  Third-party Libaries（Apache Log4J）  
Sensitiveness-Identifiable Source:  No  
#### Sink 2:  
Logging call Function:  Third-party Libaries（Apache Log4J）  
Sensitiveness-Identifiable Source:  No  
Programming Language:Java  
```Java  
// https://github.com/oVirt/ovirt-engine/blob/2d47ff282135ec678b9629cfa0eb878e2703930c/backend/manager/tools/engine-config/src/main/java/org/ovirt/engine/core/config/EngineConfig.java#L22-L38  
  
    /**  
     * Parses the arguments, validates that they are valid, instantiates the EngineConfigLogic object and executes the  
     * desired action.  
     *  
     * @param args  
     *            The arguments given by the user.  
     *  
     * @throws Exception  
     */  
    public void setUpAndExecute(String... args) throws Exception {  
        parser.parse(args);  
        log.debug("Arguments have been parsed: " + parser.engineConfigMapToString());  
        ConfigActionType actionType = parser.getConfigAction();  
        actionType.validate(parser.getEngineConfigMap());  
        setEngineConfigLogic(new EngineConfigLogic(parser));  
        engineConfigLogic.execute(); // HERE IS THE FLOW  
    }  
  
// https://github.com/oVirt/ovirt-engine/blob/2d47ff282135ec678b9629cfa0eb878e2703930c/backend/manager/tools/engine-config/src/main/java/org/ovirt/engine/core/config/EngineConfigLogic.java#L87-L116  
  
    /**  
     * Executes desired action. Assumes the parser is now holding valid arguments.  
     *  
     * @throws Exception  
     */  
    public void execute() throws Exception {  
        ConfigActionType actionType = parser.getConfigAction();  
        log.debug("execute: beginning execution of action " + actionType + ".");  
  
        switch (actionType) {  
        case ACTION_ALL:  
            printAllValues(); // HERE IS THE FLOW  
            break;  
        case ACTION_LIST:  
            listKeys();  
            break;  
        case ACTION_GET:  
            printKey(); // HERE IS THE FLOW  
            break;  
        case ACTION_SET:  
            persistValue();  
            break;  
        case ACTION_RELOAD:  
            reloadConfigurations();  
            break;  
        default: // Should have already been discovered before execute  
            log.debug("execute: unable to recognize action: " + actionType + ".");  
            throw new UnsupportedOperationException("Please tell me what to do: list? get? set? get-all? reload?");  
        }  
    }  
  
// https://github.com/oVirt/ovirt-engine/blob/2d47ff282135ec678b9629cfa0eb878e2703930c/backend/manager/tools/engine-config/src/main/java/org/ovirt/engine/core/config/EngineConfigLogic.java#L205-L249  
  
    /**  
     * Prints the values of the given key from the DB.  
     *  
     * @throws Exception  
     */  
    private void printAllValuesForKey(String key) throws Exception {  
        List<ConfigKey> keysForName = getConfigDAO().getKeysForName(key);  
        if (keysForName.size() == 0) {  
            log.debug("printKeyValues: failed to fetch key " + key + " value: no such entry with default version.");  
            throw new RuntimeException("Error fetching " + key + " value: no such entry with default version.");  
        }  
  
        StringBuilder buffer = new StringBuilder();  
        for (ConfigKey configKey : keysForName) {  
            buffer.append(String.format("%s: %s version: %s\n",  
                    key,  
                    configKey.getDisplayValue(),  
                    configKey.getVersion()));  
        }  
        buffer.deleteCharAt(buffer.length() - 1);  
        log.info(buffer); // HERE IS THE SINK 1  
    }  
  
    /**  
     * Prints all configuration values. Is the actual execution of the 'get-all' action ('-a', '--all')  
     */  
    private void printAllValues() {  
        List<ConfigurationNode> configNodes = keysConfig.getRootNode().getChildren();  
        for (ConfigurationNode node : configNodes) {  
            ConfigKey key = configKeyFactory.generateByPropertiesKey(node.getName());  
            // TODO - move to one statement for all - time permitting;  
            try {  
                printAllValuesForKey(key.getKey()); // HERE IS THE FLOW  
            } catch (Exception e) {  
                log.error("Skipping " + key.getKey() + " due to an error: " + e.getMessage());  
                log.debug("details:", e);  
            }  
        }  
    }  
  
  
// https://github.com/oVirt/ovirt-engine/blob/e8c72daec4efa8be0fcd8ea55c41e855ddd8eedf/backend/manager/tools/engine-config/src/main/java/org/ovirt/engine/core/config/EngineConfigLogic.java#L283-L301  
  
    /**  
     * If a version has been given, prints the specific value for the key and version, otherwise prints all the values  
     * for the key. Is the actual execution of the 'get' action ('-g', '--get')  
     *  
     * @throws Exception  
     */  
    private void printKey() throws Exception {  
        String key = parser.getKey();  
        String version = parser.getVersion();  
        if (StringUtils.isBlank(version)) {  
            if (getConfigKey(key) == null) {  
                throw new RuntimeException("Error fetching " + key  
                        + " value: no such entry. Please verify key name and property file support.");  
            }  
            printAllValuesForKey(key);  
        } else {  
            printKeyWithSpecifiedVersion(key, version);  
        }  
    }  
  
// https://github.com/oVirt/ovirt-engine/blob/2d47ff282135ec678b9629cfa0eb878e2703930c/backend/manager/tools/engine-config/src/main/java/org/ovirt/engine/core/config/EngineConfigLogic.java#L297-L313  
  
    /**  
     * Fetches the given key with the given version from the DB and prints it.  
     *  
     * @param key  
     * @param version  
     * @throws Exception  
     */  
    private void printKeyWithSpecifiedVersion(String key, String version) throws Exception {  
        ConfigKey configKey = fetchConfigKey(key, version);  
        if (configKey == null || configKey.getKey() == null) {  
            log.debug("getValue: error fetching " + key + " value: no such entry with version '" + version + "'.");  
            throw new RuntimeException("Error fetching " + key + " value: no such entry with version '" + version  
                    + "'.");  
        } else {  
            log.info(configKey.getDisplayValue()); // HERE IS THE SINK 2  
        }  
    }  
  
  
```  
