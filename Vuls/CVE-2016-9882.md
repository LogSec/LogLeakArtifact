## Summary:  
Software: cloud_foundry/cloud_controller  
## Fix:  
Commit: https://github.com/cloudfoundry/cloud_controller_ng/commit/21b9db9d1a58b9154f65404b34bf2e9e4c6260ae  
Change Size: +51 -6  
Author: Michael Xu  
Fix Time (of the Last Commit): 2016-12-07  
  
Fix Pattern: Sanitization -> Redaction -> Introduction -> Keyword/RegexBasedFiltration -> RedactionFunctionDefined  
Fixing-commits Count: 1  
Total Change Size: +51 -6  
## Sample logs: No  
## Logging statements:  
### Source labels:  
Type of Sensitive Information:authentication data -> the credentials returned from service brokers  
### Sink labels:  
#### Sink 1:  
Logging call Function:  Third-party Libaries（CloudFoundry Steno Logging）  
Sensitiveness-Identifiable Source:  Same Modules & Cross Files（https://github.com/cloudfoundry/cloud_controller_ng/blob/21b9db9d1a58b9154f65404b34bf2e9e4c6260ae/lib/services/service_brokers/v2/client.rb#L93） -> String Literals（credentials，finally outputed to logs）  
Programming Language:Ruby  
```Ruby  
  
# https://github.com/cloudfoundry/cloud_controller_ng/blob/21b9db9d1a58b9154f65404b34bf2e9e4c6260ae/lib/services/service_brokers/v2/http_client.rb#L115-L151  
  
      def make_request(method, uri, body, content_type)  
        client = HTTPClient.new(force_basic_auth: true)  
        client.set_auth(uri, auth_username, auth_password)  
        client.ssl_config.set_default_paths  
  
        client.ssl_config.verify_mode = verify_certs? ? OpenSSL::SSL::VERIFY_PEER : OpenSSL::SSL::VERIFY_NONE  
        client.connect_timeout = broker_client_timeout  
        client.receive_timeout = broker_client_timeout  
        client.send_timeout = broker_client_timeout  
  
        opts = { body: body, header: {} }  
  
        client.default_header = default_headers  
        opts[:header]['Content-Type'] = content_type if content_type  
        headers = default_headers.merge(opts[:header])  
  
        logger.debug "Sending #{method} to #{uri}, BODY: #{body.inspect}, HEADERS: #{headers}"  
  
        response = client.request(method, uri, opts)  
        logger.debug "Response from request to #{uri}: STATUS #{response.code}, BODY: #{redact_credentials(response)}, HEADERS: #{response.headers.inspect}" # HERE IS THE SINK 1  
  
        HttpResponse.from_http_client_response(response)  
      rescue SocketError, Errno::ECONNREFUSED => error  
        raise Errors::ServiceBrokerApiUnreachable.new(uri.to_s, method, error)  
      rescue HTTPClient::TimeoutError => error  
        raise Errors::ServiceBrokerApiTimeout.new(uri.to_s, method, error)  
      rescue => error  
        raise HttpRequestError.new(error.message, uri.to_s, method, error)  
      end  
  
      def redact_credentials(response)  
        body = MultiJson.load(response.body)  
        body['credentials'] = 'REDACTED' if body['credentials']  
        body.inspect  
      rescue  
        'Error parsing body'  
      end  
  
```  
