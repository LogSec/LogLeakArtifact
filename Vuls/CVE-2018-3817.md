## Summary:  
Software: logstash/logstash  
## Fix:  
Commit: https://github.com/andrewvc/logstash/commit/670df852f34f93e621ff2795b1ef8da0288f0fed  
Author: Andrew Cholakian  
Fix Time (of the Last Commit): 2017-12-12  
Fix Pattern: Sanitization -> Redaction -> Enhancement (Corrective Change)  
  
  
Fixing-commits Count: 1  
Total Change Size: +59 -31  
  
=========  
PR: https://github.com/elastic/logstash/pull/8785  
Commit: https://github.com/andrewvc/logstash/commit/670df852f34f93e621ff2795b1ef8da0288f0fed  
Change Size: +59 -31  
## Sample logs: Yes  
```  
[2017-11-29T17:19:51,835][WARN ][logstash.outputs.elasticsearch] You are using a deprecated config setting "document_type" set in elasticsearch. Deprecated settings will continue to work, but are scheduled for removal from logstash in the future. Document types are being deprecated in Elasticsearch 6.0, and removed entirely in 7.0. You should avoid this feature If you have any questions about this, please visit the #logstash channel on freenode irc. {:name=>"document_type", :plugin=><LogStash::Outputs::ElasticSearch hosts=>["LINK REDACTED"], bulk_path=>"/_xpack/monitoring/_bulk?system_id=logstash&system_api_version=2&interval=1s", manage_template=>"false", EMAIL REDACTED sniffing=>"false", user=>"elastic", password=>"redacted", id=>"b260803350cdde4d381b26ed09fbf1bab05949de6f00582c3242dfbf4a8d022e">}  
```  
## Logging statements:  
### Source labels:  
Type of Sensitive Information:authentication data -> sensitive information  
### Sink labels:  
#### Sink 1:  
Logging call Function:  Standard Libraries（Logger）  
Sensitiveness-Identifiable Source:  Cross Projects|Cross-Libraries（https://github.com/logstash-plugins/logstash-output-elasticsearch/blob/master/lib/logstash/plugin_mixins/elasticsearch/api_configs.rb#L12） -> Variable Names(password，finally outputed to logs)  
Programming Language:Ruby  
```Ruby  
# https://github.com/logstash-plugins/logstash-output-elasticsearch/blob/master/lib/logstash/plugin_mixins/elasticsearch/api_configs.rb#L1-L167  
  
# OMIT FOR SIMPLICITY  
    CONFIG_PARAMS = {  
        # Username to authenticate to a secure Elasticsearch cluster  
        :user => { :validate => :string },  
        # Password to authenticate to a secure Elasticsearch cluster  
        :password => { :validate => :password }, # HERE IS THE SOURCE  
  
        # Authenticate using Elasticsearch API key.  
        # format is id:api_key (as returned by https://www.elastic.co/guide/en/elasticsearch/reference/current/security-api-create-api-key.html[Create API key])  
        :api_key => { :validate => :password },  
  
        # Cloud authentication string ("<username>:<password>" format) is an alternative for the `user`/`password` configuration.  
        #  
        # For more details, check out the https://www.elastic.co/guide/en/logstash/current/connecting-to-cloud.html#_cloud_auth[cloud documentation]  
        :cloud_auth => { :validate => :password },  
  
        # The document ID for the index. Useful for overwriting existing entries in  
        # Elasticsearch with the same ID.  
        :document_id => { :validate => :string },  
  
        # HTTP Path at which the Elasticsearch server lives. Use this if you must run Elasticsearch behind a proxy that remaps  
        # the root path for the Elasticsearch HTTP API lives.  
        # Note that if you use paths as components of URLs in the 'hosts' field you may  
        # not also set this field. That will raise an error at startup  
        :path => { :validate => :string },  
  
        # HTTP Path to perform the _bulk requests to  
        # this defaults to a concatenation of the path parameter and "_bulk"  
        :bulk_path => { :validate => :string },  
# OMIT FOR SIMPLICITY  
  
  
# https://github.com/elastic/logstash/blob/e7c3d823b3257c7aef5832094ce4f7e34fe88c81/logstash-core/lib/logstash/config/mixin.rb#L93-L112  
  
    # now that we know the parameters are valid, we can obfuscate the original copy  
    # of the parameters before storing them as an instance variable  
    self.class.secure_params!(original_params)  
    @original_params = original_params  
  
    # warn about deprecated variable use  
    original_params.each do |name, value|  
      opts = self.class.get_config[name]  
      if opts && opts[:deprecated]  
        extra = opts[:deprecated].is_a?(String) ? opts[:deprecated] : ""  
        extra.gsub!("%PLUGIN%", self.class.config_name)  
        self.logger.warn("You are using a deprecated config setting " +  
                     "#{name.inspect} set in #{self.class.config_name}. " +  
                     "Deprecated settings will continue to work, " +  
                     "but are scheduled for removal from logstash " +  
                     "in the future. #{extra} If you have any questions " +  
                     "about this, please visit the #logstash channel " +  
                     "on freenode irc.", :name => name, :plugin => self) # HERE IS THE SINK 1  
  
      end  
  
```  
