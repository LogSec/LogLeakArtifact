## Summary:  
Software: aquarius_cms  
## Fix:  
Commit: https://github.com/Tryption/aquarius-core/commit/d1dfa5b8280388a0b6f2f341f0681522dbea03b0  
Change Size: +0 -2  
Author: Tryption GmbH  
Fix Time (of the Last Commit): 2019-03-16  
  
Fix Pattern: Remove -> Logging Variables  
  
Fixing-commits Count: 1  
Total Change Size: +0 -2  
  
==========  
PR: https://github.com/aquaverde/aquarius-core/pull/12  
## Sample logs: No  
## Logging statements:  
### Source labels:  
Type of Sensitive Information:authentication data -> POST and GET parameters (including passwords)  
### Sink labels:  
#### Sink 1:  
Logging call Function:  User-defined（log）  
Sensitiveness-Identifiable Source:  Same Modules & Cross Files（https://github.com/Tryption/aquarius-core/blob/500ab0c87f1bb20f06d5ddccaeb5c860967d1604/lib/db/Users.php#L50） -> String Literals（password）  
Programming Language:PHP  
```PHP  
  
// https://github.com/Tryption/aquarius-core/blob/500ab0c87f1bb20f06d5ddccaeb5c860967d1604/lib/log.php#L159-L203  
  
    function log($level, $leveltext, $msg) { # HERE IS THE SINK 1  
        // Run only if output will be used  
        if ($level >= min($this->loglevel, $this->echolevel, $this->firelevel) && $this->enabled) {  
            $logmessage = "";  
            $backtrace = "";  
            $showrequest = false; // Maybe show _REQUEST array  
            // Process exceptions  
            if ($msg instanceof Exception || $msg instanceof Error) {  
                $excmessage = method_exists($msg, 'getDetailMessage') ? $msg->getDetailMessage() : $msg->getMessage();  
                $logmessage = $leveltext.": ".$excmessage."\n".Log::prettybacktrace($msg->getTrace());  
                $showrequest = true;  
            } else {  
                $logmessage = $leveltext.": ". print_r($msg,true)."\n";  
                // Generate a backtrace if it was requested or in severe cases  
                if ($level == Log::BACKTRACE || $level >= Log::FAIL) {  
                    $backtrace = "\n".Log::prettybacktrace();  
                    $showrequest = true;  
                }  
            }  
  
            if (!headers_sent() && $level >= $this->firelevel) {  
                $this->log_firephp($msg,$level);  
            }  
              
            // Append request variables to log message if so desired  
            if ($showrequest && count($_REQUEST) > 0) $logmessage .= "REQUEST ".print_r($_REQUEST, true);  
  
            // Write to logfile  
            if ($this->file && $level >= $this->loglevel) {  
                $logfile = fopen($this->file, 'a');  
                if ($logfile) {  
                    fwrite($logfile, date("d.m.Y-H:i:s").": $logmessage$backtrace"); // HERE IS THE INNER SINK  
                    fclose($logfile);  
                }  
            }  
  
            // Print message as HTML comment  
            if ($level >= $this->echolevel) {  
                // Some messages contain double dashes which terminate HTML comments, insert zero width space  
                $zeroed = '-​-'; // three chars, one you don't see  
                $esc = str_replace('--', $zeroed, str_replace('--', $zeroed, "$logmessage$backtrace"));   
                echo "<!--\n".$esc." -->";  
            }  
        }  
    }  
  
```  
