## Summary:  
Software: cloud_foundry/user_account_and_authentication  
## Fix:  
Commit: https://github.com/cloudfoundry/uaa/commit/a61bfabbad22f646ecf1f00016b448b26a60daf8  
Change Size: +51 -9  
Fix Time (of the Last Commit): 2018-01-10  
Author: Filip Hanik  
Fix Pattern: Remove -> Logging Variable  
  
Fixing-commits Count: 1  
Total Change Size: +51 -9  
## Sample logs: No  
## Logging statements:  
### Source labels:  
Type of Sensitive Information:authentication data -> SessionID  
### Sink labels:  
#### Sink 1:  
Logging call Function:  User-defined（UaaAuditService.log,）  
Sensitiveness-Identifiable Source:  Same Modules & Cross Files（https://github.com/cloudfoundry/uaa/blob/ebbfa6a7e9530f1835aee908ab436f198f5429bc/server/src/main/java/org/cloudfoundry/identity/uaa/authentication/UaaAuthenticationDetails.java#L120） -> Variable Names（sessionId）|String Literals（sessionId，finally outputed to logs）  
Programming Language:Java  
```Java  
  
// https://github.com/cloudfoundry/uaa/blob/ef9ca3b7bd99d1872f72db1cfbb07b92a19bd1ec/server/src/main/java/org/cloudfoundry/identity/uaa/audit/event/AuditListener.java#L16-L29  
  
public class AuditListener implements ApplicationListener<AbstractUaaEvent> {  
    private final UaaAuditService uaaAuditService;  
  
    public AuditListener(UaaAuditService auditor) {  
        Assert.notNull(auditor, "[Assertion failed] - auditor is required; it must not be null");  
        this.uaaAuditService = auditor;  
    }  
  
    @Override  
    public void onApplicationEvent(AbstractUaaEvent event) {  
        event.process(uaaAuditService);  
    }  
  
}  
  
// https://github.com/cloudfoundry/uaa/blob/ef9ca3b7bd99d1872f72db1cfbb07b92a19bd1ec/server/src/main/java/org/cloudfoundry/identity/uaa/audit/event/AbstractUaaEvent.java#L46-L69  
  
public abstract class AbstractUaaEvent extends ApplicationEvent {  
  
    private static final long serialVersionUID = -7639844193401892160L;  
    private transient final String zoneId;  
  
    private Authentication authentication;  
  
    protected AbstractUaaEvent(Object source, String zoneId) {  
        super(source);  
        if (source instanceof Authentication) {  
            this.authentication = (Authentication)source;  
        }  
        this.zoneId = zoneId;  
    }  
  
    protected AbstractUaaEvent(Object source, Authentication authentication, String zoneId) {  
        super(source);  
        this.authentication = authentication;  
        this.zoneId = zoneId;  
    }  
  
    public void process(UaaAuditService auditor) {  
        auditor.log(getAuditEvent(), getAuditEvent().getIdentityZoneId()); // HERE IS THE SINK 1  
    }  
  
  
// https://github.com/cloudfoundry/uaa/blob/ef9ca3b7bd99d1872f72db1cfbb07b92a19bd1ec/server/src/main/java/org/cloudfoundry/identity/uaa/authentication/event/ClientAuthenticationSuccessEvent.java#L19-L32  
  
public class ClientAuthenticationSuccessEvent extends AbstractUaaAuthenticationEvent{  
  
    private String clientId;  
  
    public ClientAuthenticationSuccessEvent(Authentication authentication, String zoneId) {  
        super(authentication, zoneId);  
        clientId = getAuthenticationDetails().getClientId();  
    }  
  
    @Override  
    public AuditEvent getAuditEvent() {  
        return createAuditRecord(clientId, AuditEventType.ClientAuthenticationSuccess,  
                getOrigin(getAuthenticationDetails()), "Client authentication success");  
    }  
  
  
// https://github.com/cloudfoundry/uaa/blob/ef9ca3b7bd99d1872f72db1cfbb07b92a19bd1ec/server/src/main/java/org/cloudfoundry/identity/uaa/authentication/event/AbstractUaaAuthenticationEvent.java#L22-L36  
  
public abstract class AbstractUaaAuthenticationEvent extends AbstractUaaEvent {  
  
    AbstractUaaAuthenticationEvent(Authentication authentication, String zoneId) {  
        super(authentication, zoneId);  
    }  
  
    protected String getOrigin(UaaAuthenticationDetails details) {  
        return details == null ? "unknown" : details.toString();  
    }  
  
    UaaAuthenticationDetails getAuthenticationDetails() {  
        return (UaaAuthenticationDetails) getAuthentication().getDetails();  
    }  
  
}  
  
// https://github.com/cloudfoundry/uaa/blob/ebbfa6a7e9530f1835aee908ab436f198f5429bc/server/src/main/java/org/cloudfoundry/identity/uaa/authentication/UaaAuthenticationDetails.java#L105-L123  
  
    public String toString() {  
        StringBuilder sb = new StringBuilder();  
        if (origin != null) {  
            sb.append("remoteAddress=").append(origin);  
        }  
        if (clientId != null) {  
            if (sb.length() > 0) {  
                sb.append(", ");  
            }  
            sb.append("clientId=").append(clientId);  
        }  
        if (sessionId != null) {  
            if (sb.length() > 0) {  
                sb.append(", ");  
            }  
            sb.append("sessionId=").append(sessionId);  
        }  
        return sb.toString();  
    }  
  
```  
