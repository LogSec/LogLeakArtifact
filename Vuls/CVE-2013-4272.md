## Summary:  
Software: drupal/botcha  
## Fix:  
Commit: https://git.drupalcode.org/project/botcha/commit/00d22b2  
Change Size: +87 -38  
Author: Dmitry Danilson  
Fix Time (of the Last Commit): 2013-08-14  
Fix Pattern: Sanitization -> Redaction -> Enhancement (Corrective) -> Keyword/RegexBasedFiltration -> RedactionFunctionDefined  
  
Fixing-commits Count: 1  
Total Change Size: +87 -38  
## Sample logs: No  
## Logging statements:  
### Source labels:  
Type of Sensitive Information:authentication data -> the content of submitted forms; sensitive information such as usernames and passwords  
### Sink labels:  
#### Sink 1:  
Logging call Function:  Third-party Libaries（watchdog）  
Sensitiveness-Identifiable Source:  Cross Projects|Cross-Libraries（https://github.com/drupal/drupal/blob/497914920385b7016ac9c9367e0198530787adf2/modules/user/user.module#L1284） -> String Literals(pass)  
Programming Language:PHP  
```PHP  
// https://git.drupalcode.org/project/botcha/-/blob/00d22b260bd7686544309d7188ab7fad8081468f/controller/application/botcha.application.controller.inc#L70-120  
  
  public function form_alter(&$form, &$form_state, $form_id) {  
    // Get an instance of BOTCHA form controller.  
    $form_controller = $this->getController(Botcha::CONTROLLER_TYPE_FORM);  
    $botcha_form = $form_controller->getForm($form_id, FALSE);  
    // Add admin links functionality.  
    $botcha_form->addAdminLinks($form);  
    // Check if it is allowed to protect.  
    if ($botcha_form->isEnabled()) {  
      // Get a recipe book and apply all applicable recipes to the form.  
      $rbid = $botcha_form->getRecipebook();  
      $recipebook = $this->getController(Botcha::CONTROLLER_TYPE_RECIPEBOOK)->getRecipebook($rbid, FALSE);  
      if ($recipebook->isApplicable($form, $form_state)) {  
        // Apply each of recipebook's recipes ...  
        $recipe_controller = $this->getController(Botcha::CONTROLLER_TYPE_RECIPE);  
        foreach ($recipebook->getRecipes() as $recipe_id) {  
          $recipe = $recipe_controller->getRecipe($recipe_id, FALSE);  
          $recipe->apply($form, $form_state);  
          // CSS.  
          if ($css = $recipe->getCss()) {  
            $csss[] = $css;  
          }  
          // JS.  
          if ($recipe instanceof BotchaRecipeUsingJsAbstract) {  
            $jss[] = $recipe->getJsValue();  
          }  
        }  
        // ... and the recipe book itself.  
        $recipebook->apply($form, $form_state);  
        // Logging.  
        // @todo Refactor logging.  
        if (BOTCHA_LOGLEVEL >= 4) {  
          watchdog(  
            BOTCHA_LOG,  
            '%form_id form prepared by BOTCHA: added recipes - !botchas!more',  
            array(  
              '%form_id' => $form['form_id']['#value'],  
              '!botchas' => implode(', ', $recipebook->getRecipes()),  
              '!more' => ''  
                . ((BOTCHA_LOGLEVEL >= 5) ? '<br /><br />' . 'POST=<pre>' . print_r(_botcha_filter_value($_POST), 1) . '</pre>' : '')   
                . ((BOTCHA_LOGLEVEL >= 5) ? '<br /><br />' . 'GET=<pre>' . print_r(_botcha_filter_value($_GET), 1) . '</pre>' : '')  
                . ((BOTCHA_LOGLEVEL >= 5) ? '<br /><br />' . 'SERVER=<pre>' . print_r($_SERVER, 1) . '</pre>' : '')  
                . ((BOTCHA_LOGLEVEL >= 5) ? '<br /><br />' . 'form=<pre>' . print_r(_botcha_filter_form_log($form), 1) . '</pre>' : '')  
                . ((BOTCHA_LOGLEVEL >= 5 && count($jss)) ? '<br /><br />' . 'JS=<pre>' . join("\n", $jss) . '</pre>' : '')  
                . ((BOTCHA_LOGLEVEL >= 5 && count($csss)) ? '<br /><br />' . 'CSS=<pre>' . join("\n", $csss) . '</pre>' : ''),  
            ),  
            WATCHDOG_NOTICE  
          ); // HERE IS THE SINK 1  
        }  
      }  
    }  
  }  
  
  
```  
