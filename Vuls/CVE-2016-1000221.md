## Summary:  
Software: logstash/logstash  
## Fix:  
Commit: https://github.com/elastic/logstash/commit/0999050144adad7f4d99d43e561c2882fd7c512b  
Fix Time (of the Last Commit): 2016-07-07  
Author: Suyog Rao  
  
Fix Pattern: Remove -> Logging Variables  
Fixing-commits Count: 2  
Total Change Size: +32 -29  
  
==========  
Commit: https://github.com/elastic/logstash/commit/0999050144adad7f4d99d43e561c2882fd7c512b  
Change Size: +30 -25  
Time: 2016-07-07  
Author: Suyog Rao  
Commit: https://github.com/logstash-plugins/logstash-output-elasticsearch/commit/48c8075a6057c310e12c6074f8e39ed6e8db9312  
Change Size: +2 -4  
Time: 2016-06-29  
Author: Andrew Cholakian  
## Sample logs: No  
## Logging statements:  
### Source labels:  
Type of Sensitive Information:authentication data -> HTTP authorization headers  
### Sink labels:  
#### Sink 1:  
Logging call Function:  Standard Libraries（Logger）  
Sensitiveness-Identifiable Source:  Cross Projects|Cross-Library（https://github.com/logstash-plugins/logstash-output-elasticsearch/blob/def64a84226/lib/logstash/outputs/elasticsearch/http_client.rb#L124） -> String Literals（Authorization，finally outputed to logs）  
#### Sink 2:  
Logging call Function:  Standard Libraries（Logger）  
Sensitiveness-Identifiable Source:  Cross Projects|Cross-Library（https://github.com/logstash-plugins/logstash-output-elasticsearch/blob/def64a84226/lib/logstash/outputs/elasticsearch/http_client.rb#L124） -> String Literals（Authorization，finally outputed to logs）  
#### Sink 3:  
Logging call Function:  Standard Libraries（Logger）  
Sensitiveness-Identifiable Source:  Cross Projects|Cross-Library（https://github.com/logstash-plugins/logstash-output-elasticsearch/blob/def64a84226/lib/logstash/outputs/elasticsearch/http_client.rb#L124） -> String Literals（Authorization，finally outputed to logs）  
Programming Language:Ruby  
```Ruby  
  
# https://github.com/jsvd/logstash-output-elasticsearch/blob/1a7f5e1b85ee1f83341f460fdb43fd9eb4d8d693/lib/logstash/outputs/elasticsearch/common.rb#L170-L203  
  
    # Rescue retryable errors during bulk submission  
    def safe_bulk(es_actions,actions)  
      @client.bulk(es_actions)  
    rescue Manticore::SocketException, Manticore::SocketTimeout => e  
      # If we can't even connect to the server let's just print out the URL (:hosts is actually a URL)  
      # and let the user sort it out from there  
      @logger.error(  
        "Attempted to send a bulk request to Elasticsearch configured at '#{@client.client_options[:hosts]}',"+  
          " but Elasticsearch appears to be unreachable or down!",  
        :error_message => e.message,  
        :class => e.class.name,  
        :client_config => @client.client_options,  
      ) # HERE IS THE SINK 1  
      @logger.debug("Failed actions for last bad bulk request!", :actions => actions)  
  
      # We retry until there are no errors! Errors should all go to the retry queue  
      sleep @retry_max_interval  
      retry unless @stopping.true?  
    rescue => e  
      # For all other errors print out full connection issues  
      @logger.error(  
        "Attempted to send a bulk request to Elasticsearch configured at '#{@client.client_options[:hosts]}'," +  
          " but an error occurred and it failed! Are you sure you can reach elasticsearch from this machine using " +  
          "the configuration provided?",  
        :error_message => e.message,  
        :error_class => e.class.name,  
        :backtrace => e.backtrace,  
        :client_config => @client.client_options,  
      ) # HERE IS THE SINK 2  
  
      @logger.debug("Failed actions for last bad bulk request!", :actions => actions)  
  
      raise e  
    end  
  
  
# https://github.com/logstash-plugins/logstash-output-elasticsearch/blob/def64a84226002b6df09e6c12b9671ea2c79322a/lib/logstash/outputs/elasticsearch/http_client.rb#L111-L127  
  
      @client_options = {  
        :hosts => urls,  
        :ssl => client_settings[:ssl],  
        :transport_options => {  
          :socket_timeout => timeout,  
          :request_timeout => timeout,  
          :proxy => client_settings[:proxy]  
        },  
        :transport_class => ::Elasticsearch::Transport::Transport::HTTP::Manticore  
      }  
  
      if options[:user] && options[:password] then  
        token = Base64.strict_encode64(options[:user] + ":" + options[:password])  
        @client_options[:headers] = { "Authorization" => "Basic #{token}" }  
      end  
  
      @logger.debug? && @logger.debug("Elasticsearch HTTP client options", client_options) # HERE IS THE SINK 3  
  
```  
