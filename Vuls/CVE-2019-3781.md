## Summary:  
Software: cloud_foundry/command_line_interface  
## Fix:  
Commit: https://github.com/cloudfoundry/cli/commit/e223fb760db14ce4a9b48cc6033a7614a6620272  
Author: Alex Shan  
Fix Time (of the Last Commit): 2019-02-13  
Fix Pattern: Sanitization -> Redaction -> Enhancement (Corrective Change) -> Keyword/RegexBasedFiltration -> RedactionFunctionDefined  
  
  
Fixing-commits Count: 2  
Total Change Size: +239 -11  
  
========  
Commit: https://github.com/cloudfoundry/cli/commit/1a870e91894f200c4488758094897358fcf8b478  
Change Size: +34 -3  
Time: 2019-02-13  
Commit: https://github.com/cloudfoundry/cli/commit/e223fb760db14ce4a9b48cc6033a7614a6620272  
Change Size: +205 -8  
Time: 2019-02-13  
## Sample logs: No  
## Logging statements:  
### Source labels:  
Type of Sensitive Information:authentication data -> users password  
### Sink labels:  
#### Sink 1:  
Logging call Function:  User-defined（httpClient.DumpRequest）  
Sensitiveness-Identifiable Source:  跨方法-同文件（https://github.com/cloudfoundry/cli/blob/9a0a21542ceb383e18142df627432924a7a07d9e/cf/net/gateway.go#L368） -> Variable Names（authHeader）|String Literals（Authorization）  
Programming Language:Go  
```Go  
  
// https://github.com/cloudfoundry/cli/blob/9a0a21542ceb383e18142df627432924a7a07d9e/cf/net/gateway.go#L401-L438  
  
func (gateway Gateway) doRequest(request *http.Request) (*http.Response, error) {  
	var response *http.Response  
	var err error  
  
	if gateway.transport == nil {  
		makeHTTPTransport(&gateway)  
	}  
  
	httpClient := NewHTTPClient(gateway.transport, NewRequestDumper(gateway.logger))  
  
	httpClient.DumpRequest(request) // HERE IS THE SINK 1  
  
	for i := 0; i < 3; i++ {  
		response, err = httpClient.Do(request)  
		if response == nil && err != nil {  
			continue  
		} else {  
			break  
		}  
	}  
  
	if err != nil {  
		return response, err  
	}  
  
	httpClient.DumpResponse(response)  
  
	rawWarnings := strings.Split(response.Header.Get("X-Cf-Warnings"), ",")  
	for _, rawWarning := range rawWarnings {  
		if rawWarning == "" {  
			continue  
		}  
		warning, _ := url.QueryUnescape(rawWarning)  
		*gateway.warnings = append(*gateway.warnings, warning)  
	}  
  
	return response, err  
}  
  
// https://github.com/cloudfoundry/cli/blob/e223fb760db14ce4a9b48cc6033a7614a6620272/cf/net/request_dumper.go#L34-L87  
  
func (p RequestDumper) DumpRequest(req *http.Request) {  
	p.printer.Printf("\n%s [%s]\n", terminal.HeaderColor(T("REQUEST:")), time.Now().Format(time.RFC3339))  
  
	p.printer.Printf("%s %s %s\n", req.Method, req.URL.RequestURI(), req.Proto)  
  
	p.printer.Printf("Host: %s", req.URL.Host)  
  
	headers := ui.RedactHeaders(req.Header)  
	p.displaySortedHeaders(headers)  
  
	contentType := req.Header.Get("Content-Type")  
	if strings.Contains(contentType, "multipart/form-data") {  
		p.printer.Println(T("[MULTIPART/FORM-DATA CONTENT HIDDEN]"))  
	}  
  
	if req.Body == nil {  
		return  
	}  
  
	requestBody, err := ioutil.ReadAll(req.Body)  
	req.Body.Close()  
	req.Body = ioutil.NopCloser(bytes.NewBuffer(requestBody))  
  
	if len(requestBody) == 0 {  
		return  
	}  
  
	if strings.Contains(contentType, "application/json") {  
		if err != nil {  
			p.printer.Println("Unable to read Request Body:", err)  
			return  
		}  
  
		sanitizedJSON, err := ui.SanitizeJSON(requestBody)  
  
		if err != nil {  
			p.printer.Println("Failed to sanitize json body:", err)  
			return  
		}  
  
		p.printer.Printf("%s\n", sanitizedJSON)  
	}  
	if strings.Contains(contentType, "x-www-form-urlencoded") {  
  
		formData, err := url.ParseQuery(string(requestBody))  
		if err != nil {  
			p.printer.Println("Failed to parse form:", err)  
			return  
		}  
  
		redactedData := p.redactFormData(formData)  
		p.displayFormData(redactedData)  
	}  
}  
  
```  
