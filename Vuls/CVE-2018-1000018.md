## Summary:  
Software: ovirt/hosted_engine_setup  
## Fix:  
Commit: https://github.com/oVirt/ovirt-hosted-engine-setup/commit/773c346d60aa85e24658ff26d4c9e8686c0c3a53  
Change Size: +33 -9  
Author: Yedidyah Bar David  
Fix Time (of the Last Commit): 2018-01-22  
Fix Pattern: Sanitization -> Redaction -> Enhancement (Corrective Change) -> Tag/TypeBasedFiltration  
  
Fixing-commits Count: 1  
Total Change Size: +33 -9  
  
========  
Review: https://gerrit.ovirt.org/#/c/86635/  
## Sample logs: Yes  
```  
2018-01-21 21:50:08,630-0500 DEBUG otopi.context context.dumpEnvironment:823 ENVIRONMENT DUMP - BEGIN  
2018-01-21 21:50:08,630-0500 DEBUG otopi.context context.dumpEnvironment:833 ENV OVEHOSTED_ENGINE/adminPassword=str:'**FILTERED**'  
2018-01-21 21:50:08,630-0500 DEBUG otopi.context context.dumpEnvironment:833 ENV QUESTION/1/ENGINE_ADMIN_PASSWORD=str:'**FILTERED**'  
2018-01-21 21:50:08,631-0500 DEBUG otopi.context context.dumpEnvironment:833 ENV QUESTION/2/ENGINE_ADMIN_PASSWORD=str:'**FILTERED**'  
2018-01-21 21:50:08,631-0500 DEBUG otopi.context context.dumpEnvironment:837 ENVIRONMENT DUMP - END  
```  
## Logging statements:  
### Source labels:  
Type of Sensitive Information:authentication data -> root user's password  
### Sink labels:  
#### Sink 1:  
Logging call Function:  User-defined（dumpEnvironment）  
Sensitiveness-Identifiable Source:  Same Modules & Cross Files（https://github.com/oVirt/ovirt-hosted-engine-setup/blob/759fe79f273b6b2f0acfa926ebb6fa0c6a770999/src/plugins/gr-he-common/engine/ca.py#L154） -> Variable Names（ohostedcons.EngineEnv.ADMIN_PASSWORD）  
Programming Language:Python  
```python  
# https://github.com/oVirt/otopi/blob/c5a194cd3b57161f0c10907536a27e489f2175e7/src/otopi/context.py#L722-L767  
  
    def runSequence(self):  
        """Run sequence."""  
        for self._currentStage in sorted(self._sequence.keys()):  
            if_no_error = plugin.Stages.DATABASE[  
                self._currentStage  
            ]['if-success']  
  
            if (  
                not if_no_error or  
                not self.environment[constants.BaseEnv.ERROR]  
            ):  
                self.logger.info(  
                    _("Stage: {stage}").format(  
                        stage=plugin.Stages.stage_str(self._currentStage),  
                    )  
                )  
                self.logger.debug(  
                    "STAGE %s" % plugin.Stages.stage_id(self._currentStage)  
                )  
                for methodinfo in self._sequence[self._currentStage]:  
                    if (  
                        not if_no_error or  
                        not self.environment[constants.BaseEnv.ERROR]  
                    ):  
                        oldEnvironment = dict(  
                            (k, common.toStr(v))  
                            for k, v in self.environment.items()  
                        )  
                        self._executeMethod(self._currentStage, methodinfo)  
                        self.dumpEnvironment(old=oldEnvironment) # HERE IS THE Sink 1  
  
        if self.environment[constants.BaseEnv.ERROR]:  
            infos = self.environment[  
                constants.BaseEnv.EXCEPTION_INFO  
            ]  
            for exception_info in infos:  
                self.logger.debug(  
                    'Exception: %s' % (  
                        traceback.format_tb(exception_info[2])  
                    )  
                )  
  
            if infos:  
                util.raiseExceptionInformation(infos[0])  
            else:  
                raise RuntimeError(_('Error during sequence'))  
  
  
# https://github.com/oVirt/otopi/blob/c5a194cd3b57161f0c10907536a27e489f2175e7/src/otopi/context.py#L810-L837  
  
  
    def dumpEnvironment(self, old=None):  
        """Dump environment."""  
        diff = False  
        for key in sorted(self.environment.keys()):  
            value = common.toStr(self.environment[key])  
  
            if (  
                old is None or  
                key not in old or  # Dump if added, even if None  
                value != common.toStr(old.get(key))  
            ):  
                if not diff:  
                    diff = True  
                    self.logger.debug('ENVIRONMENT DUMP - BEGIN')  
  
                if key in self.environment[  
                    constants.BaseEnv.SUPPRESS_ENVIRONMENT_KEYS  
                ]:  
                    value = '***'  
                self.logger.debug(  
                    "ENV %s=%s:'%s'",  
                    key,  
                    type(self.environment[key]).__name__,  
                    value,  
                ) # HERE IS THE INNER SINK  
  
        if diff:  
            self.logger.debug('ENVIRONMENT DUMP - END')                 
  
  
```  
