## Summary:  
Software: sensu_core  
## Fix:  
Commit: https://github.com/sensu/sensu/commit/46ff10023e8cbf1b6978838f47c51b20b98fe30b  
Author: Justin Kolberg  
Fix Time (of the Last Commit): 2018-02-07  
Fix Pattern: Sanitization -> Redaction -> Enhancement (Adaptive Change) -> Keyword/RegexBasedFiltration  
  
  
Fixing-commits Count: 1  
Total Change Size: +24 -13  
  
==========  
PR: https://github.com/sensu/sensu/pull/1810  
Commit: https://github.com/sensu/sensu/commit/46ff10023e8cbf1b6978838f47c51b20b98fe30b  
Change Size: +24 -13  
## Sample logs: Yes  
```Json  
{  
   "timestamp":"2016-04-08T16:41:35.699673-0700",  
   "level":"warn",  
   "message":"config file applied changes",  
   "file":"/etc/sensu/conf.d/rabbitmq.json",  
   "changes":{  
      "rabbitmq":[  
         null,  
         [  
            {  
               "host":"1.1.1.1",  
               "port":"5671",  
               "user":"sensu",  
               "password":"abc123"  
            },  
            {  
               "host":"1.1.1.2",  
               "port":"5671",  
               "user":"sensu",  
               "password":"abc123"  
            }  
         ]  
      ]  
   }  
}  
```  
## Logging statements:  
### Source labels:  
Type of Sensitive Information:authentication data -> sensitive configuration data (e.g. passwords)  
### Sink labels:  
#### Sink 1:  
Logging call Function:  User-defined（warning）  
Sensitiveness-Identifiable Source:  Cross Projects|Cross-Libraries（https://github.com/ruby-amqp/amqp/blob/03d0cd8f403daf8de3909aa306d62514af51b172/lib/amqp.rb#L211） -> Documentations  
Programming Language:Ruby  
```ruby  
# https://github.com/sensu/sensu-settings/blob/master/lib/sensu/settings/loader.rb#L158-L187  
  
      def load_file(file, must_exist=true)  
        if File.file?(file) && File.readable?(file)  
          begin  
            warning("loading config file", :file => file)  
            contents = read_config_file(file)  
            config = contents.empty? ? {} : Sensu::JSON.load(contents)  
            merged = deep_merge(@settings, config)  
            unless @loaded_files.empty?  
              changes = deep_diff(@settings, merged)  
              warning("config file applied changes", {  
                :file => file,  
                :changes => changes  
              }) # HERE IS THE SINK 1  
            end  
            @settings = merged  
            @indifferent_access = false  
            @loaded_files << file  
          rescue Sensu::JSON::ParseError => error  
            load_error("config file must be valid json", {  
              :file => file,  
              :error => error.to_s  
            })  
          end  
        elsif must_exist  
          load_error("config file does not exist or is not readable", :file => file)  
        else  
          warning("config file does not exist or is not readable", :file => file)  
          warning("ignoring config file", :file => file)  
        end  
      end  
  
# https://github.com/sensu/sensu-settings/blob/master/lib/sensu/settings/loader.rb#L479-L488  
  
      # Record a warning.  
      #  
      # @param message [String] warning message.  
      # @param data [Hash] warning context.  
      # @return [Array] current warnings.  
      def warning(message, data={})  
        @warnings << {  
          :message => message  
        }.merge(data)  
      end  
  
```  
