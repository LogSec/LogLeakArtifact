## Summary:  
Software: freeipa  
## Fix:  
Commit: https://github.com/freeipa/freeipa/commit/02ce407f5e10e670d4788778037892b58f80adc0  
Change Size: +72 -24  
Fix Time (of the Last Commit): 2019-11-26  
Author: Rob Crittenden  
  
Fix Pattern: Sanitization -> Redaction -> Enhancement (Corrective Change)  
Fixing-commits Count: 1  
Total Change Size: +72 -24  
## Sample logs: Yes  
```  
ipa: DEBUG: raw: batch(group_find(None), passwd('test', '********', None))  
ipa: DEBUG: batch(group_find(None), passwd('test', '********', None))  
ipa: DEBUG: raw: group_find(None, version='2.233')  
ipa: DEBUG: group_find(None, private=False, posix=False, external=False, nonposix=False, all=False, raw=False, version='2.233', no_members=True, pkey_only=False)  
ipa: INFO: admin@DOMAIN.COM: batch: group_find(None): SUCCESS  
ipa: DEBUG: raw: passwd('test', '********', None, version='2.233')  
ipa: DEBUG: passwd(ipapython.kerberos.Principal('test@DOMAIN.COM'), '********', '********', version='2.233')  
ipa: INFO: admin@DOMAIN.COM: batch: passwd('test', '********', None): SUCCESS  
ipa: INFO: [jsonserver_kerb] admin@DOMAIN.COM: batch(group_find(None), passwd('test', '********', None)): SUCCESS  
  
```  
## Logging statements:  
### Source labels:  
Type of Sensitive Information:authentication data -> user passwords, commands with passwords as arguments or options  
### Sink labels:  
#### Sink 1:  
Logging call Function:  Standard Libraries（logging）  
Sensitiveness-Identifiable Source:  Same Projects & Cross Modules（https://github.com/freeipa/freeipa/blob/02ce407f5e10e670d4788778037892b58f80adc0/ipaserver/plugins/passwd.py#L97） -> Type Names（Password）|String Literals（current_password）  
#### Sink 2:  
Logging call Function:  Standard Libraries（logging）  
Sensitiveness-Identifiable Source:  Same Projects & Cross Modules（https://github.com/freeipa/freeipa/blob/02ce407f5e10e670d4788778037892b58f80adc0/ipaserver/plugins/passwd.py#L97） -> Type Names（Password）|String Literals（current_password）  
#### Sink 3:  
Logging call Function:  Standard Libraries（logging）  
Sensitiveness-Identifiable Source:  Same Modules & Cross Files（https://github.com/freeipa/freeipa/blob/02ce407f5e10e670d4788778037892b58f80adc0/ipaserver/plugins/passwd.py#L97） -> Type Names（Password）|String Literals（current_password）  
#### Sink 4:  
Logging call Function:  Standard Libraries（logging）  
Sensitiveness-Identifiable Source:  Same Modules & Cross Files（https://github.com/freeipa/freeipa/blob/02ce407f5e10e670d4788778037892b58f80adc0/ipaserver/plugins/passwd.py#L97） -> Type Names（Password）|String Literals（current_password）  
Programming Language:Python  
```python  
# https://github.com/freeipa/freeipa/blob/02ce407f5e10e670d4788778037892b58f80adc0/ipalib/frontend.py#L452-L490  
def __do_call(self, *args, **options):  
        self.context.__messages = []  
        if 'version' in options:  
            self.verify_client_version(unicode(options['version']))  
        elif self.api.env.skip_version_check and not self.api.env.in_server:  
            options['version'] = u'2.0'  
        else:  
            options['version'] = self.api_version  
            if self.api.env.in_server:  
                # add message only on server side  
                self.add_message(  
                    messages.VersionMissing(server_version=self.api_version))  
        params = self.args_options_2_params(*args, **options)  
        logger.debug(  
            'raw: %s(%s)', self.name, ', '.join(self._repr_iter(**params))  
        ) # HERE IS THE SINK 1  
        if self.api.env.in_server:  
            params.update(self.get_default(**params))  
        params = self.normalize(**params)  
        params = self.convert(**params)  
        logger.debug(  
            '%s(%s)', self.name, ', '.join(self._repr_iter(**params))  
        ) # HERE IS THE SINK 2  
        if self.api.env.in_server:  
            self.validate(**params)  
        (args, options) = self.params_2_args_options(**params)  
        ret = self.run(*args, **options)  
        if isinstance(ret, dict):  
            for message in self.context.__messages:  
                messages.add_message(options['version'], ret, message)  
        if (  
            isinstance(ret, dict)  
            and 'summary' in self.output  
            and 'summary' not in ret  
        ):  
            ret['summary'] = self.get_summary_default(ret)  
        if self.use_output_validation and (self.output or ret is not None):  
            self.validate_output(ret, options['version'])  
        return ret  
  
  
  
# https://github.com/freeipa/freeipa/blob/02ce407f5e10e670d4788778037892b58f80adc0/ipaserver/plugins/batch.py#L160-L209  
    def execute(self, methods=None, **options):  
        results = []  
        for arg in (methods or []):  
            params = dict()  
            name = None  
            try:  
                self._validate_request(arg)  
                name = arg['method']  
                a, kw = arg['params']  
                newkw = dict((str(k), v) for k, v in kw.items())  
                params = api.Command[name].args_options_2_params(  
                    *a, **newkw)  
                newkw.setdefault('version', options['version'])  
  
                result = api.Command[name](*a, **newkw)  
                logger.info(  
                    '%s: batch: %s(%s): SUCCESS',  
                    getattr(context, 'principal', 'UNKNOWN'),  
                    name,  
                    ', '.join(api.Command[name]._repr_iter(**params))  
                ) # HERE IS THE SINK 3  
                result['error']=None  
            except Exception as e:  
                if (isinstance(e, errors.RequirementError) or  
                        isinstance(e, errors.CommandError) or  
                        isinstance(e, errors.ConversionError)):  
                    logger.info(  
                        '%s: batch: %s',  
                        context.principal,  # pylint: disable=no-member  
                        e.__class__.__name__  
                    )  
                else:  
                    logger.info(  
                        '%s: batch: %s(%s): %s',  
                        context.principal, name,  # pylint: disable=no-member  
                        ', '.join(api.Command[name]._repr_iter(**params)),  
                        e.__class__.__name__  
                    ) # HERE IS THE SINK 4  
                if isinstance(e, errors.PublicError):  
                    reported_error = e  
                else:  
                    reported_error = errors.InternalError()  
                result = dict(  
                    error=reported_error.strerror,  
                    error_code=reported_error.errno,  
                    error_name=unicode(type(reported_error).__name__),  
                    error_kw=reported_error.kw,  
                )  
            results.append(result)  
        return dict(count=len(results) , results=results)  
  
```  
