## Summary:  
Software: ovirt/otopi  
## Fix:  
Commit: https://github.com/oVirt/otopi/commit/9bc269ac3c6cfed198c8b3fc81ad49f6bfefebb9  
Change Size: +32 -3  
Author: Yedidyah Bar David  
Fix Time (of the Last Commit): 2016-05-15  
Fix Pattern: Sanitization -> Redaction -> Enhancement (Adaptive Change) -> Keyword/RegexBasedFiltration -> RedactionFunctionDefined  
  
Fixing-commits Count: 1  
Total Change Size: +32 -3  
## Sample logs: Yes  
```  
2016-02-17 20:58:27 DEBUG otopi.plugins.ovirt_engine_setup.ovirt_engine.config.aaa plugin.execute:936 execute-output: ('/usr/bin/openssl', 'pkcs12', '-in', '/etc/pki/ovirt-engine/keys/engine.p12', '-passin', 'pass:**FILTERED**', '-nocerts', '-nodes') stdout:  
Bag Attributes  
    localKeyID: 73 7C 28 A3 EF AF FC 34 AA E1 43 EF 70 47 96 10 B8 AA D9 76   
Key Attributes: <No Attributes>  
-----BEGIN PRIVATE KEY-----  
MIICdgIBADANBgkqhkiG9w0BAQEFAASCAmAwggJcAgEAAoGBAKLr1i4HXEQeAi/x  
8D23j4uSzLrY5IG5nbJGa7KA0nLfEZOyCBXksSa34kohbs4xbJ0Y/3Eat5mpyily  
44Eucplgw8f9dYL/mfmh6jA0R/pwQn3lf/9mcmvmvLHBQ4Mfbpo2f4iJXy1MLq+N  
92USilpU3oVJQdQb1ovflQ7HIM0FAgMBAAECgYAu+/xkgdLmAhF3ajpyUgGfqtJI  
AEzF7JXB1/UvIV+PqS0Ufv898Rn1pIop/sJJzI8aLx9bquzP79tRYMSjeJWrmCMU  
yKClBrK3PbucLR4Pg/OnXI36Dy0IjdWw9pvxIAfwfLEi7Y8HL6JYgDNhPhL4HlAy  
T0VIzIQ6ZLJjdOPWgQJBAM60AG7AXcqidyBGfNPlopHiBBB+RXjneybqpboWWERM  
y59otT42VpuM6X5nBhA3n/6TgkrSw0Hc2wS5kYYFUc0CQQDJxslnTKoCvt2TpIqt  
c6wXVMhIHvKxXHUuJ48jqa0otAgRBq9V+BEPUVCQdaQRmVlIlMvYkU572dkLOrxG  
exAZAkA56q+wWJAvJeSRE48IZHBvxc9zu53Fqb6VAexbvsUOpiHr0Y/vFZSg0xPd  
igpl4uAemcBJLNLvEm3/3esLjVQFAkEAvYKwDQ5rKzL6xz2mZiybODqP9XTjuoM9  
J8FN5k/p663TWbJuoY7g7wMPaO6kz0a5HbtrDZfEH/zGpo5e4M+amQJAfElHDoFR  
d1NlSpy/iUgY4mNlb+5KnIf65psYgeZ77yU4ujlFJ7VuruV6SxT1Ht7ihb1ETMtf  
lIrbgpU/U9rtyg==  
-----END PRIVATE KEY-----  
```  
## Logging statements:  
### Source labels:  
Type of Sensitive Information:authentication data -> encryption keys, certificates, and other sensitive information  
### Sink labels:  
#### Sink 1:  
Logging call Function:  Standard Libraries（logging）  
Sensitiveness-Identifiable Source:  Same Projects & Cross Modules（https://github.com/oVirt/ovirt-engine/blob/c0685ff721c132bb152461c697267f0e6c82be0d/packaging/setup/plugins/ovirt-engine-setup/ovirt-engine/config/aaa.py#L217） -> Method Names（RSA.load_key_string）|Type Names（M2Crypto.RSA.RSA）  
Programming Language:Python  
```python  
# https://github.com/oVirt/otopi/blob/775c2c54368a9f0f7f95552471b3d8b98a1c42a5/src/otopi/plugin.py#L769-L934  
  
def executeRaw(  
        self,  
        args,  
        executable=None,  
        stdin=None,  
        cwd=None,  
        env=None,  
        preexec_fn=None,  
        envAppend=None,  
    ):  
        """Execute a process.  
        Keyword arguments:  
        args -- a list of command arguments.  
        executable -- executable name.  
        stdin -- binary blob.  
        cwd -- working directory.  
        env -- environment dictionary.  
        envAppend -- append environment.  
        Returns:  
        (rc, stdout, stderr)  
        stdout, stderr binary blobs.  
        """  
  
        def _isString(s):  
            return (  
                isinstance(s, str) or  
                isinstance(s, builtins.unicode)  
            )  
  
        try:  
            if envAppend is not None:  
                if env is None:  
                    env = os.environ  
                env = env.copy()  
                env.update(envAppend)  
  
            self.logger.debug(  
                "execute: %s, executable='%s', cwd='%s', env=%s",  
                args,  
                executable,  
                cwd,  
                env,  
            )  
  
            if args is not None:  
                for v in args:  
                    if not _isString(v):  
                        raise RuntimeError(  
                            _(  
                                'Bad argument when trying to execute {args}, '  
                                'Malformed argument is {argType}:{arg}.'  
                            ).format(  
                                args=args,  
                                argType=type(v),  
                                arg=v,  
                            )  
                        )  
  
            if env is not None:  
                for k, v in env.items():  
                    if not _isString(k) or not _isString(v):  
                        raise RuntimeError(  
                            _(  
                                'Bad environment when trying to execute '  
                                '{args}, Malformed environment is '  
                                '{keyType}:{key}={valueType}:{value}.'  
                            ).format(  
                                args=args,  
                                keyType=type(k),  
                                key=k,  
                                valueType=type(v),  
                                value=v,  
                            )  
                        )  
  
            p = subprocess.Popen(  
                args,  
                executable=executable,  
                stdin=subprocess.PIPE if stdin is not None else None,  
                stdout=subprocess.PIPE,  
                stderr=subprocess.PIPE,  
                close_fds=True,  
                cwd=cwd,  
                env=env,  
                preexec_fn=preexec_fn,  
            )  
            stdout, stderr = p.communicate(input=stdin)  
            rc = p.returncode  
            self.logger.debug(  
                'execute-result: %s, rc=%s',  
                args,  
                rc,  
            )  
        except Exception:  
            self.logger.debug(  
                'execute-result: %s, exception',  
                args,  
                exc_info=True  
            )  
            raise  
  
        return (rc, stdout, stderr)  
  
    def execute(  
        self,  
        args,  
        raiseOnError=True,  
        logStreams=True,  
        stdin=None,  
        *eargs,  
        **kwargs  
    ):  
        """Execute system command.  
        Keyword arguments:  
        args -- a list of command arguments.  
        raiseOnError -- raise exception if an error.  
        logStreams -- log streams' content.  
        stdin -- a list of lines.  
        eargs -- extra args to subprocess.Popen.  
        kwargs - extra kwargs to subprocess.Popen.  
        Returns:  
        (rc, stdout, stderr)  
        stdout, stderr are list of lines.  
        """  
        if logStreams and stdin is not None:  
            self.logger.debug(  
                'execute-input: %s stdin:\n%s\n',  
                args,  
                '\n'.join(stdin)  
            )  
        (rc, stdout, stderr) = self.executeRaw(  
            args=args,  
            stdin=(  
                '\n'.join(stdin).encode('utf-8')  
                if stdin is not None else None  
            ),  
            *eargs,  
            **kwargs  
        )  
        # warning: python-2.6 does not have kwargs for decode  
        stdout = stdout.decode('utf-8', 'replace').splitlines()  
        stderr = stderr.decode('utf-8', 'replace').splitlines()  
        if logStreams:  
            self.logger.debug(  
                'execute-output: %s stdout:\n%s\n',  
                args,  
                '\n'.join(stdout)  # HERE IS THE SINK 1  
            )  
            self.logger.debug(  
                'execute-output: %s stderr:\n%s\n',  
                args,  
                '\n'.join(stderr)  
            )  
        if rc != 0 and raiseOnError:  
            raise RuntimeError(  
                _("Command '{command}' failed to execute").format(  
                    command=args[0],  
                )  
            )  
        return (rc, stdout, stderr)  
  
```  
