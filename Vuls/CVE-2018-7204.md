## Summary:  
Software: file_manager  
## Fix:  
SVN: https://plugins.trac.wordpress.org/changeset/1823035/file-manager  
Author: aihimel  
Fix Time (of the Last Commit): 2018-02-15  
  
Fix Pattern: Remove -> Entire Function  
Fixing-commits Count: 1  
Total Change Size: +99 -98  

## Sample logs: No  
## Logging statements:  
### Source labels:  
Type of Sensitive Information:authentication data -> database credentials, salts, etc  
### Sink labels:  
#### Sink 1:  
Logging call Function:  User-defined（logger）  
Sensitiveness-Identifiable Source:  No  
Programming Language:PHP  
```PHP  
// https://plugins.trac.wordpress.org/browser/file-manager/trunk/inc/logger.php?rev=1728414#L54  
  
  
function logger($cmd, $result, $args, $elfinder) { // HERE IS THE SINK 1  
	         
	        global $FileManager;  
	         
	        $log = sprintf("[%s] %s: %s \n", date('r'), strtoupper($cmd), var_export($result, true));  
	        $logfile = $FileManager->upload_path . DS . 'log.txt';  
	        $dir = dirname($logfile);  
	        if (!is_dir($dir) && !mkdir($dir)) {  
	                return;  
	        }  
	        if (($fp = fopen($logfile, 'a'))) {  
	                fwrite($fp, $log);  
	                fclose($fp);  
	        }  
	        return;  
	  
	        foreach ($result as $key => $value) {  
	                if (empty($value)) {  
	                        continue;  
	                }  
	                $data = array();  
	                if (in_array($key, array('error', 'warning'))) {  
	                        array_push($data, implode(' ', $value));  
	                } else {  
	                        if (is_array($value)) { // changes made to files  
	                                foreach ($value as $file) {  
	                                        $filepath = (isset($file['realpath']) ? $file['realpath'] : $elfinder->realpath($file['hash']));  
	                                        array_push($data, $filepath);  
	                                }  
	                        } else { // other value (ex. header)  
	                                array_push($data, $value);  
	                        }  
	                }  
	                $log .= sprintf(' %s(%s)', $key, implode(', ', $data));  
	        }  
	        $log .= "\n";  
	  
	        $logfile = $FileManager->upload_path . DS . 'log.txt';  
	        $dir = dirname($logfile);  
	        if (!is_dir($dir) && !mkdir($dir)) {  
	                return;  
	        }  
	        if (($fp = fopen($logfile, 'a'))) {  
	                fwrite($fp, $log);  
	                fclose($fp);  
	        }  
	}  
	  
  
```  
