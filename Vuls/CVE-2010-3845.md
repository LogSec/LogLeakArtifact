## Summary:  
Software: apache_authenhook  
## Fix:  
Commit: https://salsa.debian.org/perl-team/modules/packages/libapache-authenhook-perl/-/commit/8dc774fce5621f2951e685bfc4a3daf8a659a6b6  
Change Size: +12 -7  
Fix Time (of the Last Commit): 2010-10-11  
Fix Pattern: Remove -> Logging Variables  
Author: Ivan Kohler  
  
Fixing-commits Count: 1  
Total Change Size: +12 -7  
## Sample logs: Yes  
```  
[Sun Oct 10 13:18:45 2010] [info] [client 80.218.213.43] Apache::AuthenHook - user 'Sesse', password '<censored for this bug report>' verified  
```  
## Logging statements:  
### Source labels:  
Type of Sensitive Information:authentication data -> usernames and passwords  
### Sink labels:  
#### Sink 1:  
Logging call Function:  Third-party Libaries（Apache httpd Logging）  
Sensitiveness-Identifiable Source:  Logging Statements -> Variable Names（password）|String Literals（password，finally outputed to logs）  
#### Sink 2:  
Logging call Function:  Third-party Libaries（Apache httpd Logging）  
Sensitiveness-Identifiable Source:  Logging Statements -> Variable Names（password）|String Literals（password，finally outputed to logs）  
Programming Language:C#  
```C#  
  
// https://salsa.debian.org/perl-team/modules/packages/libapache-authenhook-perl/-/blob/7f38880be4f3dc1a7997bd3128d4eafc69f5949d/AuthenHook.xs#L253-257  
static const authn_provider authn_AAH_provider =  
{  
  &check_password,  
  &get_realm_hash,  
};  
  
  
  
// https://salsa.debian.org/perl-team/modules/packages/libapache-authenhook-perl/-/blob/7f38880be4f3dc1a7997bd3128d4eafc69f5949d/AuthenHook.xs#L156-206  
static authn_status check_password(request_rec *r, const char *user,  
                                   const char *password)  
{  
  int status;  
  
  MP_TRACE_a(MP_FUNC,   
             "Apache::AuthenHook - calling Basic handler\n");  
  
  status = call_provider(r, "basic", user, password, NULL);  
  
  /* determine which AUTH_ status we should return based on  
   * what HTTP_ status the Perl provider returned.  and yes,   
   * this routine could be reused if I wanted to be less specific  
   * with the log messages...  */  
  
  switch(status) {  
    case AUTH_GENERAL_ERROR:  
      ap_log_rerror(APLOG_MARK, APLOG_ERR, 0, r,  
                    "Apache::AuthenHook - yikes! something bad happened!");  
      ap_log_rerror(APLOG_MARK, APLOG_INFO, 0, r,  
                    "Apache::AuthenHook - try running with PerlTrace a");  
  
      /* status is already AUTH_GENERAL_ERROR */  
      break;  
  
    case OK:  
      ap_log_rerror(APLOG_MARK, APLOG_INFO, 0, r,  
                    "Apache::AuthenHook - user '%s', password '%s' verified",  
                    user, password); // HERE IS THE SINK 1  
  
      status = AUTH_GRANTED;  
      break;  
  
    case DECLINED:  
      ap_log_rerror(APLOG_MARK, APLOG_INFO, 0, r,  
                    "Apache::AuthenHook - passing user '%s' to next provider",  
                    user);  
  
      status = AUTH_USER_NOT_FOUND;  
      break;  
  
    default:  
      ap_log_rerror(APLOG_MARK, APLOG_INFO, 0, r,  
                    "Apache::AuthenHook - user '%s', password '%s' denied",  
                    user, password); // HERE IS THE SINK 2  
  
      status = AUTH_DENIED;  
  };  
  
  return status;  
}  
  
  
  
// https://salsa.debian.org/perl-team/modules/packages/libapache-authenhook-perl/-/blob/7f38880be4f3dc1a7997bd3128d4eafc69f5949d/AuthenHook.xs#L273-276  
    ap_register_provider(modperl_global_get_pconf(),   
                         AUTHN_PROVIDER_GROUP,   
                         SvPV_nolen(newSVsv(provider)), "0",  
                         &authn_AAH_provider);  
  
  
```  
